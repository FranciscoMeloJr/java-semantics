% For bubble mode, replace \usepackage[...]{k} line in main tex file with:
%\documentclass[a4paper, landscape]{article}
%\usepackage[style=bubble, tight]{k}


%Font set latin modern is not compatible with large angular brackets (package yhmath), so we cannot use it.
%\usepackage{lmodern}

%For TOC fix
\usepackage{etoolbox}

%%% Adding TOC to PDF bookmarks.
% Source: http://tex.stackexchange.com/questions/1820/contents-in-pdf-bookmarks
\makeatletter
\pretocmd{\tableofcontents}{%
  \if@openright\cleardoublepage\else\clearpage\fi
  \pdfbookmark[0]{\contentsname}{toc}%
}{}{}%
\makeatother


%%% MARKDOWN ENV

\newcounter{MarkdownId}

%Required package fancyvrb already imported by k.sty
\newenvironment{markdown}%
    {\stepcounter{MarkdownId}%
        \VerbatimEnvironment\begin{VerbatimOut}{tmp\theMarkdownId.markdown}%
    }%
    {\end{VerbatimOut}%
        \immediate\write18{pandoc .latex\string\\tmp\theMarkdownId.markdown -t latex -o .latex\string\\tmp\theMarkdownId.tex}%
        \input{.latex\string\\tmp\theMarkdownId.tex}%
    }

%%% JAVA LSTLISTINGS SETUP
\lstset{language=Java,captionpos=t,tabsize=3,frame=no,keywordstyle=\color{blue},
        commentstyle=\color{gray},stringstyle=\color{red},
        breaklines=true,showstringspaces=false,emph={label},
        basicstyle=\ttfamily}

\makeatletter
% Call this in front of a \begin{itemize} to prevent page break before the list
% Doesn't work.
% http://tex.stackexchange.com/questions/2644/how-to-prevent-a-page-break-before-an-itemize-list
\newcommand{\nolisttopbreak}{\vspace{\topsep}\nobreak\@afterheading}
\makeatother

% #1 = sort, #2 = name
\newcommand{\cellref}[2][]{%
  %\kall{#2}{\ifthenelse{\isempty{#1}}{}{$\sortName{#1}$}}%doesn't work
  %Style 1: rendering the cell
  \kall{#2}{#1}%
  %Style 2: just cell name
  %{\color{mcellBracketDefaultColor} #2}%
}

%Wraps a group of cells and properly aligns them.
\newcommand{\kwrap}[1]{{%Additional braces to confine the scope of setkeys to this macro
  \setkeys{k}{ruleHangindent=0pt,StartVspace=0ex,EndVspace=0ex}%
  \ksentence[]{}{}{#1}{}{}{}%
}}

% Environment "kdefinition" have effect only in poster style, thus in math style may be safely deleted.

%Disable text justification, will eliminate overfulls inside text.
\raggedright
